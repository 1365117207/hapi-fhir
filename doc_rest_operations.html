<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-08-16 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="James Agnew" />
    <meta name="Date-Revision-yyyymmdd" content="20140816" />
    <meta http-equiv="Content-Language" content="en" />
    <title>HAPI &#x2013; RESTful Operations - HAPI FHIR</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<script src="syntaxhighlighter/shCore.js" type="text/javascript"></script>
                      
        
<script src="syntaxhighlighter/shBrushJScript.js" type="text/javascript"></script>
                      
        
<script src="syntaxhighlighter/shBrushJava.js" type="text/javascript"></script>
                      
        
<script src="syntaxhighlighter/shBrushBash.js" type="text/javascript"></script>
                      
        
<script src="syntaxhighlighter/shBrushXml.js" type="text/javascript"></script>
                      
        
<link rel="stylesheet" type="text/css" href="syntaxhighlighter/shCore.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="syntaxhighlighter/shThemeDefault.css"/>
                      
        
<link rel="shortcut icon" href="http://hl7api.sourceforge.net/images/favicon.png"/>
                      
        
<link rel="stylesheet" type="text/css" href="hapi.css"/>
          
                  </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://hl7api.sourceforge.net/hapi-fhir/" id="bannerLeft">
                                                                                                <img src="images/hapi_fhir_banner.png"  alt="HAPI"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://hl7api.sourceforge.net/hapi-fhir/" id="bannerRight">
                                                                                                <img src="images/hapi_fhir_banner_right.png"  alt="FHIR"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-08-16
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.6-SNAPSHOT
                      </li>
                      
                
                    
      
                                    
    <li class="pull-right">
        <span class="divider">|</span>
                      <a href="http://www.uhn.ca/" class="externalLink" title="University Health Network">
        University Health Network</a>
      </li>

  
    <li class="pull-right">
        <span class="divider">|</span>
                      <a href="http://hl7.org/" class="externalLink" title="hl7.org">
        hl7.org</a>
      </li>

  
    <li class="pull-right">
                      <a href="https://github.com/jamesagnew/hapi-fhir/" class="externalLink" title="GitHub Page">
        GitHub Page</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Welcome</li>
                              
      <li>
  
                          <a href="index.html" title="Welcome">
          <i class="none"></i>
        Welcome</a>
            </li>
                
      <li>
  
                          <a href="download.html" title="Download">
          <i class="none"></i>
        Download</a>
            </li>
                
      <li>
  
                          <a href="doc_upgrading.html" title="Upgrade Guide">
          <i class="none"></i>
        Upgrade Guide</a>
            </li>
                
      <li>
  
                          <a href="changes-report.html" title="Changelog">
          <i class="none"></i>
        Changelog</a>
            </li>
                              <li class="nav-header">Test Server</li>
                              
      <li>
  
                          <a href="http://fhirtest.uhn.ca" class="externalLink" title="Public Test Server">
          <i class="none"></i>
        Public Test Server</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="doc_intro.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                                                                                                
      <li>
  
                          <a href="doc_fhirobjects.html" title="The Data Model">
          <i class="icon-chevron-down"></i>
        The Data Model</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="doc_extensions.html" title="Extensions">
          <i class="none"></i>
        Extensions</a>
            </li>
                    
      <li>
  
                          <a href="doc_resource_references.html" title="Resource References">
          <i class="none"></i>
        Resource References</a>
            </li>
                    
      <li>
  
                          <a href="doc_tags.html" title="Tags">
          <i class="none"></i>
        Tags</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="doc_rest_client.html" title="RESTful Client">
          <i class="none"></i>
        RESTful Client</a>
            </li>
                                                                                                                            
      <li>
  
                          <a href="doc_rest_server.html" title="RESTful Server">
          <i class="icon-chevron-down"></i>
        RESTful Server</a>
                    <ul class="nav nav-list">
                    
      <li class="active">
  
            <a href="#"><i class="none"></i>RESTful Operations</a>
          </li>
                    
      <li>
  
                          <a href="doc_narrative.html" title="Narrative Generator">
          <i class="none"></i>
        Narrative Generator</a>
            </li>
                    
      <li>
  
                          <a href="doc_cors.html" title="CORS Support">
          <i class="none"></i>
        CORS Support</a>
            </li>
                    
      <li>
  
                          <a href="doc_server_tester.html" title="Web Testing UI">
          <i class="none"></i>
        Web Testing UI</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="doc_logging.html" title="Logging">
          <i class="none"></i>
        Logging</a>
            </li>
                
      <li>
  
                          <a href="doc_tinder.html" title="Tinder Plugin">
          <i class="none"></i>
        Tinder Plugin</a>
            </li>
                              <li class="nav-header">Community</li>
                              
      <li>
  
                          <a href="https://groups.google.com/d/forum/hapi-fhir" class="externalLink" title="Google Group">
          <i class="none"></i>
        Google Group</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/jamesagnew/hapi-fhir/issues" class="externalLink" title="Issue Tracker">
          <i class="none"></i>
        Issue Tracker</a>
            </li>
                              <li class="nav-header">JavaDocs</li>
                              
      <li>
  
                          <a href="apidocs/index.html" title="API Documentation">
          <i class="none"></i>
        API Documentation</a>
            </li>
                
      <li>
  
                          <a href="xref/index.html" title="JXR">
          <i class="none"></i>
        JXR</a>
            </li>
                              <li class="nav-header">Reports</li>
                              
      <li>
  
                          <a href="team-list.html" title="Developers">
          <i class="none"></i>
        Developers</a>
            </li>
                
      <li>
  
                          <a href="surefire-report.html" title="Unit Test Report">
          <i class="none"></i>
        Unit Test Report</a>
            </li>
                
      <li>
  
                          <a href="findbugs.html" title="FindBugs">
          <i class="none"></i>
        FindBugs</a>
            </li>
                
      <li>
  
                          <a href="license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
                
      <li>
  
                          <a href="http://sourceforge.net/p/hl7api/fhircode/ci/master/tree/" class="externalLink" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
            </ul>
                
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="jamesagnew.github.io/hapi-fhir/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="https://sourceforge.net/projects/hl7api/" title="Hosted on SourceForge.net" class="builtBy">
        <img class="builtBy"  alt="Hosted on SourceForge.net" src="http://sflogo.sourceforge.net/sflogo.php?group_id=38899&type=2"    />
      </a>
                                                                                                          <a href="http://maven.apache.org" title="Built with Maven 2" class="builtBy">
        <img class="builtBy"  alt="Built with Maven 2" src="images/logos/maven-feather.png"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            

	

		<div class="section">
<h2><a name="Implementing_Resource_Provider_Operations"></a>Implementing Resource Provider Operations</h2>

			
<p>
				Jump To...
			</p>
			
<ul>
				
<li>
					<a href="#operations">Operations</a>
				</li>
				
<li>
					<a href="#exceptions">Exceptions</a>
				</li>
				
<li>
					<a href="#tags">Tags</a>
				</li>
			</ul>

			
<p>
				RESTful Clients and Servers both share the same
				method pattern, with one key difference: A client
				is defined using annotated methods on an interface
				which are used to retrieve
				resources,
				whereas a server requires concrete method
				implementations
				to actually provide those resources.
			</p>

			
<p>
				Unless otherwise specified, the examples below show
				<b>server</b>
				implementations, but client methods will follow the same patterns.
			</p>

			<a name="operations"></a>
		</div>

		
<div class="section">
<h2><a name="Operations"></a>Operations</h2>
			
<p>
				The following table lists the operations supported by
				HAPI FHIR RESTful Servers and Clients.
			</p>

			
<table border="0" class="table table-striped">
				<thead>
					
<tr class="a" style="font-weight: bold; font-size: 1.2em;">
						
<td>Operation</td>
						
<td>Definition</td>
					</tr>
				</thead>
				<tbody>
					
<tr class="b">
						
<td>
							<a href="#instance_read">Instance - Read</a>
						</td>
						
<td>
							Read the current state of the resource
						</td>
					</tr>
					
<tr class="a">
						
<td>
							<a href="#instance_vread">Instance - VRead</a>
						</td>
						
<td>
							Read the state of a specific version of the resource
						</td>
					</tr>
					
<tr class="b">
						
<td>
							<a href="#instance_update">Instance - Update</a>
						</td>
						
<td>
							Read the state of a specific version of the resource
						</td>
					</tr>
					
<tr class="a">
						
<td>
							<a href="#instance_delete">Instance - Delete</a>
						</td>
						
<td>
							Delete a resource
						</td>
					</tr>
					
<tr class="b">
						
<td>
							<a href="#history">Instance - History</a>
						</td>
						
<td>
							Retrieve the update history for a particular resource
						</td>
					</tr>
					
<tr class="a">
						
<td>
							<a href="#type_create">Type - Create</a>
						</td>
						
<td>
							Create a new resource with a server assigned id
						</td>
					</tr>
					
<tr class="b">
						
<td>
							<a href="#type_search">Type - Search</a>
							
								
								
							
<ul>
<li><a href="#Search_with_No_Parameters">Search with No Parameters</a></li>
<li><a href="#Search_Parameters:_String_Introduction">Search Parameters: String Introduction</a></li>
<li><a href="#Search_Parameters:_TokenIdentifier">Search Parameters: Token/Identifier</a></li>
<li><a href="#Search_Parameters:_Date_Simple">Search Parameters: Date (Simple)</a></li>
<li><a href="#Search_Parameters:_Date_Ranges">Search Parameters: Date (Ranges)</a>
<ul>
<li><a href="#Unbounded_Ranges">Unbounded Ranges</a></li></ul></li>
<li><a href="#Search_Parameters:_Quantity">Search Parameters: Quantity</a></li>
<li><a href="#Search_Parameters:_Resource_Reference">Search Parameters: Resource Reference</a>
<ul>
<li><a href="#Static_Chains">Static Chains</a></li></ul></li>
<li><a href="#Search_Parameters:_Composite">Search Parameters: Composite</a></li>
<li><a href="#Combining_Multiple_Parameters">Combining Multiple Parameters</a></li>
<li><a href="#Multi-Valued_ANDOR_Parameters">Multi-Valued (AND/OR) Parameters</a>
<ul>
<li><a href="#OR_Relationship_Query_Parameters">OR Relationship Query Parameters</a></li>
<li><a href="#AND_Relationship_Query_Parameters">AND Relationship Query Parameters</a></li>
<li><a href="#AND_Relationship_Query_Parameters_for_Dates">AND Relationship Query Parameters for Dates</a></li></ul></li>
<li><a href="#Resource_Includes__include">Resource Includes (_include)</a></li>
<li><a href="#Named_Queries__query">Named Queries (_query)</a></li>
<li><a href="#Sorting__sort">Sorting (_sort)</a></li>
<li><a href="#Adding_Descriptions">Adding Descriptions</a></li></ul>
						</td>
						
<td>
							Search the resource type based on some filter criteria
						</td>
					</tr>
					
<tr class="a">
						
<td>
							<a href="#history">Type - History</a>
						</td>
						
<td>
							Retrieve the update history for a particular resource type
						</td>
					</tr>
					
<tr class="b">
						
<td>
							<a href="#type_validate">Type - Validate</a>
						</td>
						
<td>
							Check that the content would be acceptable as an update
						</td>
					</tr>
					
<tr class="a">
						
<td>
							<a href="#system_conformance">System - Conformance</a>
						</td>
						
<td>
							Get a conformance statement for the system
						</td>
					</tr>
					
<tr class="b">
						
<td>
							<a href="#system_transaction">System - Transaction</a>
						</td>
						
<td>
							Update, create or delete a set of resources as a single transaction
						</td>
					</tr>
					
<tr class="a">
						
<td>
							<a href="#history">System - History</a>
						</td>
						
<td>
							Retrieve the update history for all resources
						</td>
					</tr>
					
<tr class="b">
						
<td>
							<a href="#system_search">System - Search</a>
						</td>
						
<td>
							Search across all resource types based on some filter criteria
						</td>
					</tr>
					
<tr class="a">
						
<td>
							<a href="#tags">Tag Operations</a>
						</td>
						
<td>
							Search across all resource types based on some filter criteria
						</td>
					</tr>

				</tbody>
			</table>

			<a name="instance_read"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Instance_Level_-_Read"></a>Instance Level - Read</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#read">
					<b>read</b>
				</a>
				operation retrieves a resource by ID. It is annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/Read.html">@Read</a>
				annotation, and has a single parameter annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/IdParam.html">@IdParam</a>
				annotation.
			</p>

			
				
				
			
<div class="source">
<pre>@Read()
public Patient getResourceById(@IdParam IdDt theId) {
   Patient retVal = new Patient();
   
   // ...populate...
   retVal.addIdentifier().setSystem(&quot;urn:mrns&quot;).setValue(&quot;12345&quot;).setLabel(&quot;MRN 12345&quot;);
   retVal.addName().addFamily(&quot;Smith&quot;).addGiven(&quot;Tester&quot;).addGiven(&quot;Q&quot;);
   // ...etc...
   
   // if you know the version ID of the resource, you should set it and HAPI will 
   // include it in a Content-Location header
   retVal.setId(new IdDt(&quot;Patient&quot;, &quot;123&quot;, &quot;2&quot;));
   
   return retVal;
}
</pre></div>

			
<p>
				Example URL to invoke this method:
				<br />
				<tt>http://fhir.example.com/Patient/111</tt>
			</p>

			
<p>
				The following snippet shows how to define a client interface
				to handle a read method.
			</p>

			
				
				
			
<div class="source">
<pre>private interface IPatientClient extends IBasicClient
{
  /** Read a patient from a server by ID */
  @Read
  Patient readPatient(@IdParam IdDt theId);

  // Only one method is shown here, but many methods may be 
  // added to the same client interface!
}
</pre></div>

			<a name="instance_vread"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Instance_Level_-_VRead"></a>Instance Level - VRead</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#vread">
					<b>vread</b>
				</a>
				operation retrieves a specific version of a resource with a given ID.
				To support vread, simply add &quot;version=true&quot; to your @Read annotation. This
				means that the read method will support both &quot;Read&quot; and &quot;VRead&quot;. The IdDt
				may or may not have the version populated depending on the client request. 
			</p>

			
				
				
			
<div class="source">
<pre>@Read(version=true)
public Patient readOrVread(@IdParam IdDt theId) {
   Patient retVal = new Patient();

   if (theId.hasVersionIdPart()) {
      // this is a vread   
   } else {
      // this is a read
   }

   // ...populate...
   
   return retVal;
}
</pre></div>

			
<p>
				Example URL to invoke this method:
				<br />
				<tt>http://fhir.example.com/Patient/111/_history/2</tt>
			</p>
			
			<a name="instance_update"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Instance_Level_-_Update"></a>Instance Level - Update</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#update">
					<b>update</b>
				</a>
				operation updates a specific resource instance (using its ID), and optionally
				accepts a version ID as well (which can be used to detect version conflicts).
			</p>
			
<p>
				Update methods must be annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/Update.html">@Update</a>
				annotation, and have a parameter annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/ResourceParam.html">@Resource</a>
				annotation. This parameter contains the resource instance to be created.
			</p>
			
<p>
				In addition, the method must have a parameter annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/IdParam.html">@IdParam</a>
				annotation, and optionally may have a parameter annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/VersionIdParam.html">@VersionIdParam</a>
			</p>
			
<p>
				Update methods must return an object of type
				<a href="./apidocs/ca/uhn/fhir/rest/api/MethodOutcome.html">MethodOutcome</a>
				. This
				object contains the identity of the created resource.
			</p>
			
<p>
				The following snippet shows how to define an update method on a server:
			</p>

			
				
				
			
<div class="source">
<pre>@Update
public MethodOutcome updatePatient(@IdParam IdDt theId, @ResourceParam Patient thePatient) {

  /* 
   * First we might want to do business validation. The UnprocessableEntityException
   * results in an HTTP 422, which is appropriate for business rule failure
   */
  if (thePatient.getIdentifierFirstRep().isEmpty()) {
    /* It is also possible to pass an OperationOutcome resource
     * to the UnprocessableEntityException if you want to return
     * a custom populated OperationOutcome. Otherwise, a simple one
     * is created using the string supplied below. 
     */
    throw new UnprocessableEntityException(&quot;No identifier supplied&quot;);
  }

  String versionId = theId.getVersionIdPart();
  if (versionId != null) {
    // If the client passed in a version number in the request URL, which means they are
    // doing a version-aware update. You may wish to throw an exception if the supplied
    // version is not the latest version.
    if (detectedVersionConflict) {
      throw new ResourceVersionConflictException(&quot;Invalid version&quot;);
    }
  }
  
  // Save this patient to the database...
  savePatientToDatabase(theId, thePatient);

  // This method returns a MethodOutcome object which contains
  // the ID and Version ID for the newly saved resource
  MethodOutcome retVal = new MethodOutcome();
  String newVersion = &quot;2&quot;; // may be null if the server is not version aware
  retVal.setId(theId.withVersion(newVersion));
  
  // You can also add an OperationOutcome resource to return
  // This part is optional though:
  OperationOutcome outcome = new OperationOutcome();
  outcome.addIssue().setDetails(&quot;One minor issue detected&quot;);
  retVal.setOperationOutcome(outcome);
  
  // If your server supports creating resources during an update if they don't already exist
  // (this is not mandatory and may not be desirable anyhow) you can flag in the response
  // that this was a creation as follows:
 // retVal.setCreated(true);
  
  return retVal;
}
</pre></div>

			
<p>
				Example URL to invoke this method (this would be invoked using an HTTP PUT,
				with the resource in the PUT body):
				<br />
				<tt>http://fhir.example.com/Patient</tt>
			</p>

			
<p>
				The following snippet shows how the corresponding client interface
				would look:
			</p>

			
				
				
			
<div class="source">
<pre>@Update
public abstract MethodOutcome updateSomePatient(@IdParam IdDt theId, @ResourceParam Patient thePatient);
</pre></div>

			<a name="instance_delete"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Instance_Level_-_Delete"></a>Instance Level - Delete</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#delete">
					<b>delete</b>
				</a>
				operation retrieves a specific version of a resource with a given ID. It takes a single
				ID parameter annotated with an
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/IdParam.html">@IdParam</a>
				annotation, which supplies the ID of the resource to delete.
			</p>

			
				
				
			
<div class="source">
<pre>@Read()
public void deletePatient(@IdParam IdDt theId) {
	// .. Delete the patient ..
	if (couldntFindThisId) {
		throw new ResourceNotFoundException(&quot;Unknown version&quot;);
	}
	if (conflictHappened) {
		throw new ResourceVersionConflictException(&quot;Couldn't delete because [foo]&quot;);
	}
	// otherwise, delete was successful
	return; // can also return MethodOutcome
}
</pre></div>

			
<p>
				Delete methods are allowed to return the following types:
			</p>
			
<ul>
				
<li>
					<b>void</b>
					: This method may return
					<tt>void</tt>
					, in which case
					the server will return an empty response and the client will ignore
					any successful response from the server (failure responses will still throw
					an exception)
				</li>
				
<li>
					<b>
						<a href="./apidocs/ca/uhn/fhir/rest/api/MethodOutcome.html">MethodOutcome</a>
					</b>
					:
					This method may return
					<tt>MethodOutcome</tt>
					,
					which is a wrapper for the FHIR OperationOutcome resource, which may optionally be returned
					by the server according to the FHIR specification.
				</li>
			</ul>

			
<p>
				Example URL to invoke this method (HTTP DELETE):
				<br />
				<tt>http://fhir.example.com/Patient/111</tt>
			</p>

			<a name="type_create"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Type_Level_-_Create"></a>Type Level - Create</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#create">
					<b>create</b>
				</a>
				operation saves a new resource to the server, allowing the server to
				give that resource an ID and version ID.
			</p>
			
<p>
				Create methods must be annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/Create.html">@Create</a>
				annotation, and have a single parameter annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/ResourceParam.html">@Resource</a>
				annotation. This parameter contains the resource instance to be created.
			</p>
			
<p>
				Create methods must return an object of type
				<a href="./apidocs/ca/uhn/fhir/rest/api/MethodOutcome.html">MethodOutcome</a>
				. This
				object contains the identity of the created resource.
			</p>
			
<p>
				The following snippet shows how to define a server create method:
			</p>

			
				
				
			
<div class="source">
<pre>@Create
public MethodOutcome createPatient(@ResourceParam Patient thePatient) {

  /* 
   * First we might want to do business validation. The UnprocessableEntityException
   * results in an HTTP 422, which is appropriate for business rule failure
   */
  if (thePatient.getIdentifierFirstRep().isEmpty()) {
    /* It is also possible to pass an OperationOutcome resource
     * to the UnprocessableEntityException if you want to return
     * a custom populated OperationOutcome. Otherwise, a simple one
     * is created using the string supplied below. 
     */
    throw new UnprocessableEntityException(&quot;No identifier supplied&quot;);
  }
	
  // Save this patient to the database...
  savePatientToDatabase(thePatient);

  // This method returns a MethodOutcome object which contains
  // the ID (composed of the type Patient, the logical ID 3746, and the
  // version ID 1)
  MethodOutcome retVal = new MethodOutcome();
  retVal.setId(new IdDt(&quot;Patient&quot;, &quot;3746&quot;, &quot;1&quot;));
  
  // You can also add an OperationOutcome resource to return
  // This part is optional though:
  OperationOutcome outcome = new OperationOutcome();
  outcome.addIssue().setDetails(&quot;One minor issue detected&quot;);
  retVal.setOperationOutcome(outcome);  
  
  return retVal;
}
</pre></div>

			
<p>
				Example URL to invoke this method (this would be invoked using an HTTP POST,
				with the resource in the POST body):
				<br />
				<tt>http://fhir.example.com/Patient</tt>
			</p>

			
<p>
				The following snippet shows how the corresponding client interface
				would look:
			</p>

			
				
				
			
<div class="source">
<pre>@Create
public abstract MethodOutcome createNewPatient(@ResourceParam Patient thePatient);
</pre></div>

			<a name="type_search"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Type_Level_-_Search"></a>Type Level - Search</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#search">
					<b>search</b>
				</a>
				operation returns a bundle
				with zero-to-many resources of a given type, matching a given set of parameters.
			</p>

			
<div class="section">
<h3><a name="Search_with_No_Parameters"></a>Search with No Parameters</h3>

				
<p>
					The following example shows a search with no parameters. This operation
					should return all resources of a given type (this obviously doesn't make
					sense in all contexts, but
					does for some resource types).
				</p>

				
					
					
				
<div class="source">
<pre>@Search
public List&lt;Organization&gt; getAllOrganizations() {
   List&lt;Organization&gt; retVal=new ArrayList&lt;Organization&gt;(); // populate this
   return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Patient</tt>
				</p>

			</div>
			
<div class="section">
<h3><a name="Search_Parameters:_String_Introduction"></a>Search Parameters: String Introduction</h3>

				
<p>
					To allow a search using given search parameters, add one or more parameters
					to your search method and tag these parameters as either
					<a href="./apidocs/ca/uhn/fhir/rest/annotation/RequiredParam.html">@RequiredParam</a>
					or
					<a href="./apidocs/ca/uhn/fhir/rest/annotation/OptionalParam.html">@OptionalParam</a>
					.
				</p>

				
<p>
					This annotation takes a &quot;name&quot; parameter which specifies the parameter's
					name (as it will appear in the search URL). FHIR defines standardized parameter
					names for each
					resource, and these are available as constants on the
					individual HAPI resource
					classes.
				</p>
				
				
<p>
					Parameters which take a string as their format should use the 
					<a href="./apidocs/ca/uhn/fhir/rest/param/StringParam.html">StringParam</a>
					type. They may also use normal java Strings, although it is
					not possible to use the &quot;:exact&quot; qualifier in that case.
				</p>

				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Patient&gt; searchByLastName(@RequiredParam(name=Patient.SP_FAMILY) StringParam theFamily) {
   String valueToMatch = theFamily.getValue();
   
   if (theFamily.isExact()) {
	   // Do an exact match search
   } else {
	   // Do a fuzzy search if possible
   }
   
   // ...populate...
   Patient patient = new Patient();
   patient.addIdentifier().setSystem(&quot;urn:mrns&quot;).setValue(&quot;12345&quot;).setLabel(&quot;MRN 12345&quot;);
   patient.addName().addFamily(&quot;Smith&quot;).addGiven(&quot;Tester&quot;).addGiven(&quot;Q&quot;);
   // ...etc...

   //  Every returned resource must have its logical ID set. If the server
   //  supports versioning, that should be set too
   String logicalId = &quot;4325&quot;;
   String versionId = &quot;2&quot;; // optional
   patient.setId(new IdDt(&quot;Patient&quot;, logicalId, versionId));
   
   /*
    * This is obviously a fairly contrived example since we are always
    * just returning the same hardcoded patient, but in a real scenario
    * you could return as many resources as you wanted, and they
    * should actually match the given search criteria.
    */
   List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
   retVal.add(patient);
   
   return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Patient?family=SMITH</tt>
				</p>

			</div>
			
<div class="section">
<h3><a name="Search_Parameters:_TokenIdentifier"></a>Search Parameters: Token/Identifier</h3>

				
<p>
					The &quot;token&quot; type is used for parameters which have two parts, such as
					an idnetifier (which has a system URI, as well as the actual identifier)
					or a code (which has a code system, as well as the actual code).
					For example, the search below can be used to search by
					identifier (e.g. search for an MRN).
				</p>

				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Patient&gt; searchByIdentifier(@RequiredParam(name=Patient.SP_IDENTIFIER) TokenParam theId) {
   String identifierSystem = theId.getSystem();
   String identifier = theId.getValue();
   
   List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
   // ...populate...
   return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Patient?identifier=urn:foo|7000135</tt>
				</p>

			</div>

			
<div class="section">
<h3><a name="Search_Parameters:_Date_Simple"></a>Search Parameters: Date (Simple)</h3>

				
<p>
					The FHIR specification provides a sytax for specifying
					dates+times (but for simplicity we will just say dates here)
					as search criteria.
				</p>

				
<p>
					Dates may be optionally prefixed with a qualifier. For example, the
					string
					<tt>&gt;=2011-01-02</tt>
					means any date on or after 2011-01-02.
				</p>

				
<p>
					To accept a qualified date parameter, use the
					DateParam parameter type.
				</p>

				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Patient&gt; searchByObservationNames( @RequiredParam(name=Patient.SP_BIRTHDATE) DateParam theDate ) {
   QuantityCompararatorEnum comparator = theDate.getComparator(); // e.g. &lt;=
   Date date = theDate.getValue(); // e.g. 2011-01-02
   TemporalPrecisionEnum precision = theDate.getPrecision(); // e.g. DAY
	
   List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
   // ...populate...
   return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Observation?birthdate=&gt;=2011-01-02</tt>
				</p>

				
<p>
					Invoking a client of thie type involves the following syntax:
				</p>

				
					
					
				
<div class="source">
<pre>DateParam param = new DateParam(QuantityCompararatorEnum.GREATERTHAN_OR_EQUALS, &quot;2011-01-02&quot;);
List&lt;Patient&gt; response = client.getPatientByDob(param);
</pre></div>

			</div>

			<a name="DATE_RANGES"></a>
			
<div class="section">
<h3><a name="Search_Parameters:_Date_Ranges"></a>Search Parameters: Date (Ranges)</h3>

				
<p>
					A common scenario in searches is to allow searching for resources
					with values (i.e timestamps) within a range of dates.
				</p>

				
<p>
					FHIR allows for multiple parameters with the same key, and interprets
					these as being an &quot;AND&quot; set. So, for example, a range of
					<br />
					<tt>DATE &gt;= 2011-01-01</tt>
					and
					<tt>DATE &lt; 2011-02-01</tt>
					<br />
					can be interpreted as any date within January 2011.
				</p>

				
<p>
					The following snippet shows how to accept such a range, and combines it
					with a specific identifier, which is a common scenario. (i.e. Give me a list
					of observations for a
					specific patient within a given date range)
				</p>
				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Observation&gt; searchByDateRange(
    @RequiredParam(name=Observation.SP_DATE) DateRangeParam theRange ) {
  
  Date from = theRange.getLowerBoundAsInstant();
  Date to = theRange.getUpperBoundAsInstant();
	
  List&lt;Observation&gt; retVal = new ArrayList&lt;Observation&gt;();
  // ...populate...
  return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Observation?subject.identifier=7000135&amp;date=&gt;=2011-01-01&amp;date=&lt;2011-02-01</tt>
				</p>

				
<p>
					Invoking a client of this type involves the following syntax:
				</p>

				
					
					
				
<div class="source">
<pre>DateParam param = new DateParam(QuantityCompararatorEnum.GREATERTHAN_OR_EQUALS, &quot;2011-01-02&quot;);
List&lt;Patient&gt; response = client.getPatientByDob(param);
</pre></div>

				
<div class="section">
<h4><a name="Unbounded_Ranges"></a>Unbounded Ranges</h4>

				
<p>
					Note that when using a date range parameter, it is also possible for
					the client to request an &quot;unbounded&quot; range. In other words, a range that
					only a start date and no end
					date, or vice versa.
				</p>

				
<p>
					An example of this might be the following URL, which refers to any Observation
					resources for the given MRN and having a date after 2011-01-01.
					<br />
					<tt>http://fhir.example.com/Observation?subject.identifier=7000135&amp;date=&gt;=2011-01-01</tt>
					<br />
					When such a request is made of a server (or to make such a request from a client),
					the
					<tt>getLowerBound()</tt>
					or
					<tt>getUpperBound()</tt>
					property of the
					<tt>DateRangeParam</tt>
					object will be set to
					<tt>null</tt>
					.
				</p>

			</div></div>

			
<div class="section">
<h3><a name="Search_Parameters:_Quantity"></a>Search Parameters: Quantity</h3>

				
<p>
					Quantity parameters allow a number with units and a comparator
				</p>

				
<p>
					The following snippet shows how to accept such a range, and combines it
					with a specific identifier, which is a common scenario. (i.e. Give me a list
					of observations for a
					specific patient within a given date range)
				</p>
				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Observation&gt; getObservationsByQuantity(
        @RequiredParam(name=Observation.SP_VALUE_QUANTITY) QuantityParam theQuantity) {
  
  List&lt;Observation&gt; retVal = new ArrayList&lt;Observation&gt;();
  
  QuantityCompararatorEnum comparator = theQuantity.getComparator();
  DecimalDt value = theQuantity.getValue();
  String units = theQuantity.getUnits();
  // .. Apply these parameters ..
  
  // ... populate ...
  return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Observation?value-quantity=&lt;=123.2||mg</tt>
				</p>

			</div>

			
<div class="section">
<h3><a name="Search_Parameters:_Resource_Reference"></a>Search Parameters: Resource Reference</h3>

				
<p>
					Many search parameters refer to resource references. For instance, the Patient
					parameter &quot;provider&quot; refers to the resource marked as the managing organization
					for patients.
				</p>
				
<p>
					Reference parameters use the 
					<a href="./apidocs/ca/uhn/fhir/rest/param/ReferenceParam.html">ReferenceParam</a> 
					type. Reference param objects being passed into server methods will have three properties
					populated:
				</p>
				
<ul>
					
<li>
						<b>The resource type (optional):</b> This is the type of resource
						being targeted, if the client specifies one in the URL.
					</li>
					
<li>
						<b>The chain property (optional):</b> This is the name of the 
						property on the target resource to search for
					</li>
					
<li>
						<b>The value (required):</b> This is the actual value to search for. If
						a chain property has not been specified, this is the ID of the resource.
					</li>
				</ul>

				
					
					
				
<div class="source">
<pre>@Search
public List&lt;Patient&gt; findPatients(
		@RequiredParam(name=Patient.SP_PROVIDER) ReferenceParam theProvider
		) {

// May be populated with the resource type (e.g. &quot;Patient&quot;) if the client requested one
String type = theProvider.getResourceType(); 

// May be populated with the chain (e.g. &quot;name&quot;) if the client requested one
String chain = theProvider.getChain();

/* The actual parameter value. This will be the resource ID if no chain was provided,
 * but refers to the value of a specific property noted by the chain if one was given.
 * For example, the following request: 
 * http://example.com/fhir/Patient?provider:Organization.name=FooOrg
 * has a type of &quot;Organization&quot; and a chain of &quot;name&quot;, meaning that
 * the returned patients should have a provider which is an Organization
 * with a name matching &quot;FooOrg&quot;.
 */
String value = theProvider.getValue();

List&lt;Patient&gt; retVal=new ArrayList&lt;Patient&gt;(); // populate this
return retVal;

}
</pre></div>

				
<p>
					Example URLs to invoke this method:
					<br />
					Resource by ID: <tt>http://fhir.example.com/Patient?provider=1234</tt>
					<br />
					Resource by chained parameter value: <tt>http://fhir.example.com/Patient?provider:Organization.name=FooOrg</tt>
				</p>

				
<div class="section">
<h4><a name="Static_Chains"></a>Static Chains</h4>

				
<p>
					It is also possible to explicitly state a chained value right in the parameter name.
					This is useful if you want to only support a search by a specific given chained
					parameter. It has the added bonus that you can use the correct parameter type of
					the chained parameter (in this case a TokenParameter because the Patient.identifier
					parameter is a token)
				</p>

				
					
					
				
<div class="source">
<pre>@Search
public List&lt;Patient&gt; findObservations(
		@RequiredParam(name=Observation.SP_SUBJECT+'.'+Patient.SP_IDENTIFIER) TokenParam theProvider
		) {

  String system = theProvider.getSystem();
  String identifier = theProvider.getValue();

  // ...Do a search for all observations for the given subject...
  
  List&lt;Patient&gt; retVal=new ArrayList&lt;Patient&gt;(); // populate this
  return retVal;

}
</pre></div>

			</div></div>

			
<div class="section">
<h3><a name="Search_Parameters:_Composite"></a>Search Parameters: Composite</h3>

				
<p>
					Composite search parameters incorporate two parameters in a single
					value. Each of those parameters will themselves have a parameter type.
				</p>

				
<p>
					In the following example, Observation.name-value-date is shown. This parameter
					is a composite of a string and a date. Note that the composite parameter types
					(StringParam and DateParam) must be specified in both the annotation's 
					<tt>compositeTypes</tt> field, as well as the generic types for the
					<tt>CompositeParam</tt> method parameter itself.
				</p>
				
				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Observation&gt; searchByComposite(
		@RequiredParam(name=Observation.SP_NAME_VALUE_DATE, compositeTypes= {TokenParam.class, DateParam.class}) 
		CompositeParam&lt;TokenParam, DateParam&gt; theParam) {
  // Each of the two values in the composite param are accessible separately.
  // In the case of Observation's name-value-date, the left is a string and
  // the right is a date.
  TokenParam observationName = theParam.getLeftValue();
  DateParam observationValue = theParam.getRightValue();
	
  List&lt;Observation&gt; retVal = new ArrayList&lt;Observation&gt;();
  // ...populate...
  return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Observation?name-value-date=PROCTIME$2001-02-02</tt>
				</p>

			</div>

			
<div class="section">
<h3><a name="Combining_Multiple_Parameters"></a>Combining Multiple Parameters</h3>

				
<p>
					Search methods may take multiple parameters, and these parameters
					may (or may not) be optional.
					To add a second required parameter, annotate the
					parameter with
					<a href="./apidocs/ca/uhn/fhir/rest/annotation/RequiredParam.html">@RequiredParam</a>
					.
					To add an optional parameter (which will be passed in as
					<tt>null</tt>
					if no value
					is supplied), annotate the method with
					<a href="./apidocs/ca/uhn/fhir/rest/annotation/OptionalParam.html">@OptionalParam</a>
					.
				</p>

				
<p>
					You may annotate a method with any combination of as many @RequiredParam and as many @OptionalParam
					parameters as you want. It is valid to have only @RequiredParam
					parameters, or
					only @OptionalParam parameters, or any combination of the two.
				</p>

				
<p>
					If you wish to create a server that can accept any combination of a large number
					of parameters, (this is how the various reference servers behave, as well as the 
					<a class="externalLink" href="http://fhirtest.uhn.ca">public HAPI server</a>) 
					the easiest way to accomplish this is to simply create one method
					with all allowable parameters, each annotated as @OptionalParam.
				</p>

				
<p>
					On the other hand, if you have specific combinations of parameters you wish to 
					support (a common scenario if you are building FHIR on top of existing data sources
					and only have certain indexes you can use) you could create multiple search methods,
					each with specific required and optional parameters matching the database indexes.
				</p>
				
				
<p>
					The following example shows a method with two parameters.
				</p>
				
				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Patient&gt; searchByNames( @RequiredParam(name=Patient.SP_FAMILY) StringParam theFamilyName,
                                    @OptionalParam(name=Patient.SP_GIVEN)  StringParam theGivenName ) {
   String familyName = theFamilyName.getValue();
   String givenName = theGivenName != null ? theGivenName.getValue() : null;
   
   List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
   // ...populate...
   return retVal;
}
</pre></div>

				
<p>
					Example URLs to invoke this method:
					<br />
					<tt>http://fhir.example.com/Patient?family=SMITH</tt>
					<br />
					<tt>http://fhir.example.com/Patient?family=SMITH&amp;given=JOHN</tt>
				</p>

			</div>

			
<div class="section">
<h3><a name="Multi-Valued_ANDOR_Parameters"></a>Multi-Valued (AND/OR) Parameters</h3>

				
<p>
					It is possible to accept multiple values of a single parameter
					as well. This is useful in cases when you want to return a list
					of resources with criteria matching a list of
					possible values.
					See the
					<a class="externalLink" href="http://www.hl7.org/implement/standards/fhir/search.html#combining">FHIR Specification</a>
					for more information.
				</p>

				
<p>
					The FHIR specification allows two types of composite parameters:
				</p>
				
<ul>
					
<li>
						Where a parameter may accept multiple comma separated values within a single value string
						(e.g.
						<tt>?language=FR,NL</tt>
						) this is treated as an
						<b>OR</b>
						relationship, and
						the search should return elements matching either one or the other.
					</li>
					
<li>
						Where a parameter may accept multiple value strings for the same parameter name
						(e.g.
						<tt>?language=FR&amp;language=NL</tt>
						) this is treated as an
						<b>AND</b>
						relationship,
						and the search should return only elements matching both.
					</li>
				</ul>

				
<p>
					It is worth noting that according to the FHIR specification, you can have an
					AND relationship combining multiple OR relationships, but not vice-versa. In
					other words, it's possible to support a search like 
					<tt>(&quot;name&quot; = (&quot;joe&quot; or &quot;john&quot;)) AND (&quot;age&quot; = (11 or 12))</tt> but not
					a search like
					<tt>(&quot;language&quot; = (&quot;en&quot; AND &quot;fr&quot;) OR (&quot;address&quot; = (&quot;Canada&quot; AND &quot;Quebec&quot;))</tt>
				</p>

				
<div class="section">
<h4><a name="OR_Relationship_Query_Parameters"></a>OR Relationship Query Parameters</h4>

				
<p>
					To accept a composite parameter, use a parameter type which implements the
					<a href="./apidocs/ca/uhn/fhir/model/api/IQueryParameterOr.html">IQueryParameterOr</a>
					interface. 
				</p>
				
<p>
					Each parameter type (StringParam, TokenParam, etc.) has a corresponding parameter
					which accepts an OR list of parameters. These types are called &quot;[type]OrListParam&quot;, for example:
					StringOrListParam and TokenOrListParam.
				</p>
				
<p>
					The following example shows a search for Observation by name, where a list of
					names may be passed in (and the expectation is that the server will return Observations
					that match any of these names):
				</p>

				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Observation&gt; searchByObservationNames( 
		@RequiredParam(name=Observation.SP_NAME) TokenOrListParam theCodings ) {

   // The list here will contain 0..* codings, and any observations which match any of the 
   // given codings should be returned
   List&lt;CodingDt&gt; wantedCodings = theCodings.getListAsCodings();
   
   List&lt;Observation&gt; retVal = new ArrayList&lt;Observation&gt;();
   // ...populate...
   return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Observation?name=urn:fakenames|123,urn:fakenames|456</tt>
				</p>

				</div>
<div class="section">
<h4><a name="AND_Relationship_Query_Parameters"></a>AND Relationship Query Parameters</h4>

				
<p>
					To accept a composite parameter, use a parameter type which implements the
					<a href="./apidocs/ca/uhn/fhir/model/api/IQueryParameterAnd.html">IQueryParameterAnd</a>
					interface.
				</p>
				
<p>
					An example follows which shows a search for Patients by address, where multiple string 
					lists may be supplied by the client. For example, the client might request that the
					address match <tt>(&quot;Montreal&quot; OR &quot;Sherbrooke&quot;) AND (&quot;Quebec&quot; OR &quot;QC&quot;)</tt> using
					the following query:
					<br />
					<tt>http://fhir.example.com/Patient?address=Montreal,Sherbrooke&amp;address=Quebec,QC</tt>
				</p>
				
<p>
					The following code shows how to receive this parameter using a 
					<a href="./apidocs/ca/uhn/fhir/rest/param/StringAndListParam.html">StringAndListParameter</a>,
					which can handle an AND list of multiple OR lists of strings.
				</p>
				
				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;Patient&gt; searchByPatientAddress( 
		@RequiredParam(name=Patient.SP_ADDRESS) StringAndListParam theAddressParts ) {

  // StringAndListParam is a container for 0..* StringOrListParam, which is in turn a
  // container for 0..* strings. It is a little bit weird to understand at first, but think of the
  // StringAndListParam to be an AND list with multiple OR lists inside it. So you will need 
  // to return results which match at least one string within every OR list. 
  List&lt;StringOrListParam&gt; wantedCodings = theAddressParts.getValuesAsQueryTokens();
  for (StringOrListParam nextOrList : wantedCodings) {
    List&lt;StringParam&gt; queryTokens = nextOrList.getValuesAsQueryTokens();
	// Only return results that match at least one of the tokens in the list below
    for (StringParam nextString : queryTokens) {
    	   // ....check for match...
    }
  }
  
  List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
  // ...populate...
  return retVal;
}
</pre></div>
				
				</div>
<div class="section">
<h4><a name="AND_Relationship_Query_Parameters_for_Dates"></a>AND Relationship Query Parameters for Dates</h4>
				
				
<p>
					Dates are a bit of a special case, since it is a common scenario to want to match
					a date range (which is really just an AND query on two qualified date parameters).
					See the section below on <a href="#DATE_RANGES">date ranges</a>
					for	an example of a DateRangeParameter.
				</p>

			</div></div>

			
<div class="section">
<h3><a name="Resource_Includes__include"></a>Resource Includes (_include)</h3>

				
<p>
					FHIR allows clients to request that specific linked resources be included
					as contained resources, which means that they will be &quot;embedded&quot; in a special
					container called
					&quot;contained&quot; within the parent resource.
				</p>

				
<p>
					HAPI allows you to add a parameter for accepting includes if you wish
					to support them for specific search methods.
				</p>

				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;DiagnosticReport&gt; getDiagnosticReport( 
               @RequiredParam(name=DiagnosticReport.SP_IDENTIFIER) 
               TokenParam theIdentifier,
               
               @IncludeParam(allow= {&quot;DiagnosticReport.subject&quot;}) 
               Set&lt;Include&gt; theIncludes ) {
	
  List&lt;DiagnosticReport&gt; retVal = new ArrayList&lt;DiagnosticReport&gt;();
 
  // Assume this method exists and loads the report from the DB
  DiagnosticReport report = loadSomeDiagnosticReportFromDatabase(theIdentifier);

  // If the client has asked for the subject to be included:
  if (theIncludes.contains(new Include(&quot;DiagnosticReport.subject&quot;))) {
	 
    // The resource reference should contain the ID of the patient
    IdDt subjectId = report.getSubject().getReference();
	
    // So load the patient ID and return it
    Patient subject = loadSomePatientFromDatabase(subjectId);
    report.getSubject().setResource(subject);
	
  }
 
  retVal.add(report);
  return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/DiagnosticReport?identifier=7000135&amp;_include=DiagnosticReport.subject</tt>
				</p>

				
<p>
					It is also possible to use a String type for the include parameter,
					which is more convenient if only a single include (or null for none)
					is all that is required.
				</p>

				
					
					
				
<div class="source">
<pre>@Search()
public List&lt;DiagnosticReport&gt; getDiagnosticReport( 
             @RequiredParam(name=DiagnosticReport.SP_IDENTIFIER) 
             TokenParam theIdentifier,
             
             @IncludeParam(allow= {&quot;DiagnosticReport.subject&quot;}) 
             String theInclude ) {
	
  List&lt;DiagnosticReport&gt; retVal = new ArrayList&lt;DiagnosticReport&gt;();

  // Assume this method exists and loads the report from the DB
  DiagnosticReport report = loadSomeDiagnosticReportFromDatabase(theIdentifier);

  // If the client has asked for the subject to be included:
  if (&quot;DiagnosticReport.subject&quot;.equals(theInclude)) {
	 
    // The resource reference should contain the ID of the patient
    IdDt subjectId = report.getSubject().getReference();
	
    // So load the patient ID and return it
    Patient subject = loadSomePatientFromDatabase(subjectId);
    report.getSubject().setResource(subject);
	
  }

  retVal.add(report);
  return retVal;
}
</pre></div>

			</div>

			
<div class="section">
<h3><a name="Named_Queries__query"></a>Named Queries (_query)</h3>

				
<p>
					FHIR supports
					<a class="externalLink" href="http://www.hl7.org/implement/standards/fhir/search.html#advanced">named queries</a>
					,
					which may have specific behaviour defined. The following example shows how to create a Search
					operation with a name.
				</p>

				
<p>
					This operation can only be invoked by explicitly specifying the given query name
					in the request URL. Note that the query does not need to take any parameters.
				</p>

				
					
					
				
<div class="source">
<pre>@Search(queryName=&quot;namedQuery1&quot;)
public List&lt;Patient&gt; searchByNamedQuery(@RequiredParam(name=&quot;someparam&quot;) StringParam theSomeParam) {
 List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
 // ...populate...
 return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Patient?_query=namedQuery1&amp;someparam=value</tt>
				</p>

			</div>

			
<div class="section">
<h3><a name="Sorting__sort"></a>Sorting (_sort)</h3>

				
<p>
					FHIR supports
					<a class="externalLink" href="http://www.hl7.org/implement/standards/fhir/search.html#sort">sorting</a>
					according to a specific set of rules.
				</p>

				
<p>
					According to the specification, sorting is requested by the client using a 
					search param as the sort key. For example, when searching Patient resources,
					a sort key of &quot;given&quot; requests the &quot;given&quot; search param as the sort key. That
					param maps to the values in the field &quot;Patient.name.given&quot;. 
				</p>

				
<p>
					Sort specifications can be passed into handler methods by adding a parameter
					of type 
					SortSpec,
					which has been annotated with the
					@Sort
					annotation, as shown in the following example:
				</p>

				
					
					
				
<div class="source">
<pre>@Search
public List&lt;Patient&gt; findPatients(
		@RequiredParam(name=Patient.SP_IDENTIFIER) StringParam theParameter,
		@Sort SortSpec theSort) {
   List&lt;Patient&gt; retVal=new ArrayList&lt;Patient&gt;(); // populate this

   // theSort is null unless a _sort parameter is actually provided 
   if (theSort != null) {
      
      // The name of the param to sort by
      String param = theSort.getParamName();

      // The sort order, or null
      SortOrderEnum order = theSort.getOrder();

      // This will be populated if a second _sort was specified
      SortSpec subSort = theSort.getChain();
      
      // ...apply the sort...
   }

   return retVal;
}
</pre></div>

				
<p>
					Example URL to invoke this method:
					<br />
					<tt>http://fhir.example.com/Patient?_identifier=urn:foo|123&amp;_sort=given</tt>
				</p>

			</div>

			
<div class="section">
<h3><a name="Adding_Descriptions"></a>Adding Descriptions</h3>

				
<p>
					It is also possible to annotate search methods and/or parameters with
					the 
					<a href="./apidocs/ca/uhn/fhir/model/api/annotation/Description.html">@Description</a>
					annotation. This annotation allows you to add a description of the method 
					and the individual parameters. These descriptions will be placed in the
					server's metadata statement, which can be helpful to anyone who is developing
					software against your server.
				</p>

				
					
					
				
<div class="source">
<pre>@Description(shortDefinition=&quot;This search finds all patient resources matching a given name combination&quot;)
@Search()
public List&lt;Patient&gt; searchWithDocs( 
          @Description(shortDefinition=&quot;This is the patient's last name - Supports partial matches&quot;)
          @RequiredParam(name=Patient.SP_FAMILY) StringParam theFamilyName,

          @Description(shortDefinition=&quot;This is the patient's given names&quot;)
          @OptionalParam(name=Patient.SP_GIVEN)  StringParam theGivenName ) {
	
  List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
  // ...populate...
  return retVal;
}
</pre></div>

			</div>
			
			<a name="type_validate"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Type_Level_-_Validate"></a>Type Level - Validate</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#validate">
					<b>validate</b>
				</a>
				operation tests whether a resource passes business validation, and would be
				acceptable for saving to a server (e.g. by a create or update method).
			</p>
			
<p>
				Validate methods must be annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/Validate.html">@Validate</a>
				annotation, and have a parameter annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/ResourceParam.html">@Resource</a>
				annotation. This parameter contains the resource instance to be created.
			</p>
			
<p>
				Validate methods may optionally also have a parameter
				oftype IdDt annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/IdParam.html">@IdParam</a>
				annotation. This parameter contains the resource ID (see the
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#validation">FHIR specification</a>
				for details on how this is used)
			</p>
			
<p>
				Validate methods must return normally if the resource validates successfully,
				or throw an
				<a href="./apidocs/ca/uhn/fhir/rest/server/exceptions/UnprocessableEntityException.html">UnprocessableEntityException</a>
				or
				<a href="./apidocs/ca/uhn/fhir/rest/server/exceptions/InvalidRequestException.html">InvalidRequestException</a>
				if the validation fails.
			</p>
			
<p>
				Validate methods must return either:
			</p>
			
<ul>
				
<li>
					<b>void</b>
					- The method should throw an exception for a validation failure, or return normally.
				</li>
				
<li>
					An object of type
					<a href="./apidocs/ca/uhn/fhir/rest/api/MethodOutcome.html">MethodOutcome</a>
					. The
					MethodOutcome may optionally be populated with an OperationOutcome resource, which
					will be returned to the client if it exists.
				</li>
			</ul>
			
<p>
				The following snippet shows how to define a server validate method:
			</p>

			
				
				
			
<div class="source">
<pre>@Validate
public MethodOutcome validatePatient(@ResourceParam Patient thePatient) {

  // Actually do our validation: The UnprocessableEntityException
  // results in an HTTP 422, which is appropriate for business rule failure
  if (thePatient.getIdentifierFirstRep().isEmpty()) {
    /* It is also possible to pass an OperationOutcome resource
     * to the UnprocessableEntityException if you want to return
     * a custom populated OperationOutcome. Otherwise, a simple one
     * is created using the string supplied below. 
     */
    throw new UnprocessableEntityException(&quot;No identifier supplied&quot;);
  }
	
  // This method returns a MethodOutcome object
  MethodOutcome retVal = new MethodOutcome();

  // You may also add an OperationOutcome resource to return
  // This part is optional though:
  OperationOutcome outcome = new OperationOutcome();
  outcome.addIssue().setSeverity(IssueSeverityEnum.WARNING).setDetails(&quot;One minor issue detected&quot;);
  retVal.setOperationOutcome(outcome);  

  return retVal;
}
</pre></div>

			
<p>
				Example URL to invoke this method (this would be invoked using an HTTP POST,
				with the resource in the POST body):
				<br />
				<tt>http://fhir.example.com/Patient/_validate</tt>
			</p>

			<a name="system_conformance"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="System_Level_-_Conformance"></a>System Level - Conformance</h2>

			
<p>
				FHIR defines that a FHIR Server must be able to export a conformance statement,
				which is an instance of the
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/conformance.html">Conformance</a>
				resource describing the server itself.
			</p>

			
<p>
				The HAPI FHIR RESTful server will automatically export such
				a conformance statement. See the
				<a href="./doc_rest_server.html">RESTful Server</a>
				documentation for more information.
			</p>

			
<p>
				If you wish to override this default behaviour by creating
				your own metadata provider, you simply need to define a class
				with a method annotated using the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/Metadata.html">@Metadata</a>
				annotation.
			</p>
			
				
				
			
<div class="source">
<pre>public class ConformanceProvider {

  @Metadata
  public Conformance getServerMetadata() {
    Conformance retVal = new Conformance();
    // ..populate..
    return retVal;
  }

}
</pre></div>

			
<p>
				To create a Client which can retrieve a Server's conformance
				statement is simple. First, define your Client Interface, using
				the @Metadata annotation:
			</p>
			
				
				
			
<div class="source">
<pre>public interface MetadataClient extends IRestfulClient {
  
  @Metadata
  Conformance getServerMetadata();
  
  // ....Other methods can also be added as usual....
  
}
</pre></div>

			
<p>
				Then use the standard
				<a href="doc_rest_client.html">RESTful Client</a>
				mechanism for instantiating
				a client:
			</p>
			
				
				
			
<div class="source">
<pre>FhirContext ctx = new FhirContext();
MetadataClient client = ctx.newRestfulClient(MetadataClient.class, &quot;http://spark.furore.com/fhir&quot;);
Conformance metadata = client.getServerMetadata();
System.out.println(ctx.newXmlParser().encodeResourceToString(metadata));
</pre></div>

			<a name="system_transaction"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="System_Level_-_Transaction"></a>System Level - Transaction</h2>

			
<p>
				The 
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#transaction">transaction</a>
				action is among the most challenging parts of the FHIR specification to implement. It allows the
				user to submit a bundle containing a number of resources to be created/updated/deleted as a single
				atomic transaction.
			</p>

			
<p>
				HAPI provides a skeleton for implementing this action, although most of the effort
				will depend on the underlying implementation. The following example shows
				how to define a <i>transaction</i> method.
			</p>
			
				
				
			
<div class="source">
<pre>@Transaction
public List&lt;IResource&gt; transaction(@TransactionParam List&lt;IResource&gt; theResources) {
   // theResources will contain a complete bundle of all resources to persist
   // in a single transaction
   for (IResource next : theResources) {
      InstantDt deleted = (InstantDt) next.getResourceMetadata().get(ResourceMetadataKeyEnum.DELETED_AT);
      if (deleted != null &amp;&amp; deleted.isEmpty() == false) {
         // delete this resource
      } else {
         // create or update this resource
      }
   }

   // According to the specification, a bundle must be returned. This bundle will contain
   // all of the created/updated/deleted resources, including their new/updated identities.
   //
   // The returned list must be the exact same size as the list of resources
   // passed in, and it is acceptable to return the same list instance that was
   // passed in. 
   List&lt;IResource&gt; retVal = new ArrayList&lt;IResource&gt;(theResources);
   for (IResource next : theResources) {
      /*
       * Populate each returned resource with the new ID for that resource,
       * including the new version if the server supports versioning.
       */
      IdDt newId = new IdDt(&quot;Patient&quot;, &quot;1&quot;, &quot;2&quot;); 
      next.setId(newId);
   }

   // If wanted, you may optionally also return an OperationOutcome resource
   // If present, the OperationOutcome must come first in the returned list.
   OperationOutcome oo = new OperationOutcome();
   oo.addIssue().setSeverity(IssueSeverityEnum.INFORMATION).setDetails(&quot;Completed successfully&quot;);
   retVal.add(0, oo);
   
   return retVal;
}
</pre></div>
			
			
<p>
				Example URL to invoke this method:
				<br />
				<tt>POST http://fhir.example.com/</tt><br />
				<i>(note that the content of this POST will be a bundle)</i>
			</p>
			

			<a name="system_search"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="System_Level_-_Search"></a>System Level - Search</h2>

			
<p>
				Not yet implemented - Get in touch if you would like to help!
			</p>

			<a name="history"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="History_Instance_Type_Server"></a>History (Instance, Type, Server)</h2>

			
<p>
				The
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#history">
					<b>history</b>
				</a>
				operation retrieves a historical collection of all versions of a single resource
				<i>(instance history)</i>
				, all resources of a given type
				<i>(type history)</i>
				,
				or all resources of any type on a server
				<i>(server history)</i>
				.
			</p>
			
<p>
				History methods must be annotated with the
				<a href="./apidocs/ca/uhn/fhir/rest/annotation/History.html">@History</a>
				annotation, and will have additional requirements depending on the kind
				of history method intended:
			</p>
			
<ul>
				
<li>
					For an
					<b>Instance History</b>
					method, the method must have a parameter
					annotated with the
					<a href="./apidocs/ca/uhn/fhir/rest/annotation/IdParam.html">@IdParam</a>
					annotation, indicating the ID of the resource for which to return history.
					
<ul>
						
<li>
							For a server
							implementation, the method must either be defined in a
							<a href="./doc_rest_server.html#resource_providers">resource provider</a>
							or have a
							<tt>type()</tt>
							value in the @History annotation if it is
							defined in a
							<a href="./doc_rest_server.html#plain_providers">plain provider</a>
							.
						</li>
					</ul>
				</li>
				
<li>
					For a
					<b>Type History</b>
					method, the method must not have any @IdParam parameter.
					
<ul>
						
<li>
							For a server
							implementation, the method must either be defined in a
							<a href="./doc_rest_server.html#resource_providers">resource provider</a>
							or have a
							<tt>type()</tt>
							value in the @History annotation if it is
							defined in a
							<a href="./doc_rest_server.html#plain_providers">plain provider</a>
							.
						</li>
					</ul>
				</li>
				
<li>
					For a
					<b>Server History</b>
					method, the method must not have any @IdParam parameter, and
					must not have a
					<tt>type()</tt>
					value specified in
					the @History annotation.
					
<ul>
						
<li>
							In a server implementation, the method must
							be defined in a
							<a href="./doc_rest_server.html#plain_providers">plain provider</a>
							.
						</li>
					</ul>
				</li>
			</ul>
			
<p>
				The following snippet shows how to define a history method on a server:
			</p>

			
				
				
			
<div class="source">
<pre>@History()
public List&lt;Patient&gt; getPatientHistory(@IdParam IdDt theId) {
   List&lt;Patient&gt; retVal = new ArrayList&lt;Patient&gt;();
   
   Patient patient = new Patient();
   patient.addName().addFamily(&quot;Smith&quot;);
   
   // Set the ID and version
   patient.setId(theId.withVersion(&quot;1&quot;));
   
   // ...populate the rest...
   return retVal;
}
</pre></div>

			
<p>
				The following snippet shows how to define various history methods in a client.
			</p>

			
				
				
			
<div class="source">
<pre>public interface HistoryClient extends IBasicClient {
  /** Server level (history of ALL resources) */ 
  @History
  Bundle getHistoryServer();

  /** Type level (history of all resources of a given type) */
  @History(type=Patient.class)
  Bundle getHistoryPatientType();

  /** Instance level (history of a specific resource instance by type and ID) */
  @History(type=Patient.class)
  Bundle getHistoryPatientInstance(@IdParam IdDt theId);

  /**
   * Either (or both) of the &quot;since&quot; and &quot;count&quot; paramaters can
   * also be included in any of the methods above.
   */
  @History
  Bundle getHistoryServerWithCriteria(@Since Date theDate, @Count Integer theCount);

}
</pre></div>

			<a name="exceptions"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Exceptions"></a>Exceptions</h2>

			
<p>
				When implementing a server operation, there are a number of failure conditions
				specified. For example, an
				<a href="#instance_read">Instance Read</a>
				request might specify an unknown
				resource ID, or a
				<a href="#type_create">Type Create</a>
				request might contain an
				invalid resource which can not be created.
			</p>
			
<p>
				In these cases, an appropriate exception should be thrown. The HAPI RESTful
				API includes a set of exceptions extending
				<a href="./apidocs/ca/uhn/fhir/rest/server/exceptions/BaseServerResponseException.html">BaseServerResponseException</a>
				which represent specific HTTP failure codes.
			</p>
			
<p>
				See the
				<a href="./apidocs/ca/uhn/fhir/rest/server/exceptions/package-summary.html">Exceptions List</a>
				for a complete list of these exceptions. Note that these exceptions are all
				<b>unchecked</b>
				exceptions, so they do not need to ne explicitly declared in the method
				signature.
			</p>

			<a name="tags"></a>
		</div>

		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->
		<!-- ****************************************************************** -->

		
<div class="section">
<h2><a name="Tags"></a>Tags</h2>

			
<p>
				FHIR RESTful servers may support a feature known as tagging. Tags are a set of
				named flags called &quot;terms&quot; (with an optional accompanying human friendly name
				called a &quot;label&quot;,
				and an optional namespace called a &quot;scheme&quot;).
			</p>
			
<p>
				Tags have very specific semantics, which may not be
				obvious simply by using the HAPI API. It is important to review the specification
				pages
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/http.html#tags">here</a>
				and
				<a class="externalLink" href="http://hl7.org/implement/standards/fhir/extras.html#tags">here</a>
				before attempting to implement tagging in your own applications.
			</p>
		
			
<div class="section">
<h3><a name="Accessing_Tags_in_a_Read__VRead__Search_Method"></a>Accessing Tags in a Read / VRead / Search Method</h3>
			
				
<p>
					Tags are stored within a resource object, in the 
					<a href="./apidocs/ca/uhn/fhir/model/api/IResource.html#getResourceMetadata">IResource.html#getResourceMetadata()</a>
					map, under the key 
					<a href="./apidocs/ca/uhn/fhir/model/api/ResourceMetadataKeyEnum.html#TAG_LIST">TAG_LIST</a>.
				</p>
				
				
<p>
					In a server implementation, you may populate your tags into the
					returned resource(s) and HAPI will automatically place these tags into
					the response headers (for read/vread) or the bundle category tags (for search).
					The following example illustrates how to return tags from a server method. This
					example shows how to supply tags in a read method, but the same approach applies
					to vread and search operations as well.
				</p>
				
				
					
					
				
<div class="source">
<pre>@Read()
public Patient readPatient(@IdParam IdDt theId) {
  Patient retVal = new Patient();
 
  // ..populate demographics, contact, or anything else you usually would..
 
  // Create a TagList and place a complete list of the patient's tags inside
  TagList tags = new TagList();
  tags.addTag(&quot;http://animals&quot;, &quot;Dog&quot;, &quot;Canine Patient&quot;); // TODO: more realistic example
  tags.addTag(&quot;http://personality&quot;, &quot;Friendly&quot;, &quot;Friendly&quot;); // TODO: more realistic example
  
  // The tags are then stored in the Patient resource instance
  retVal.getResourceMetadata().put(ResourceMetadataKeyEnum.TAG_LIST, tags);
 
  return retVal;
}
</pre></div>
				
				
<p>
					In a client operation, you simply call the read/vread/search method as you
					normally would (as described above), and if any tags have been returned
					by the server, these may be accessed from the resource metadata.
				</p>
				
				
					
					
				
<div class="source">
<pre>IPatientClient client = new FhirContext().newRestfulClient(IPatientClient.class, &quot;http://foo/fhir&quot;);
Patient patient = client.readPatient(new IdDt(&quot;1234&quot;));
  
// Access the tag list
TagList tagList = (TagList) patient.getResourceMetadata().get(ResourceMetadataKeyEnum.TAG_LIST);
for (Tag next : tagList) {
  // ..process the tags somehow..
}
</pre></div>
				
			</div>

			
<div class="section">
<h3><a name="Setting_Tags_in_a_CreateUpdate_Method"></a>Setting Tags in a Create/Update Method</h3>
				
				
<p>
					Within a <a href="#type_create">Type Create</a>
					or <a href="#instance_update">Instance Update</a> method, it is
					possible for the client to specify a set of tags to be stored
					along with the saved resource instance. 
				</p>
				
<p>
					Note that FHIR specifies that in an update method, any tags supplied
					by the client are copied to the newly saved version, as well as any
					tags the existing version had.
				</p>
				
				
<p>
					To work with tags in a create/update method, the pattern used in the
					read examples above is simply revered. In a server, the resource which
					is passed in will be populated with any tags that the client supplied:
				</p>

				
					
					
				
<div class="source">
<pre>@Create
public MethodOutcome createPatientResource(@ResourceParam Patient thePatient) {

  // ..save the resouce..
  IdDt id = new IdDt(&quot;123&quot;); // the new databse primary key for this resource

  // Get the tag list
  TagList tags = (TagList) thePatient.getResourceMetadata().get(ResourceMetadataKeyEnum.TAG_LIST);
  for (Tag tag : tags) {
    // process/save each tag somehow	
  }
  
  return new MethodOutcome(id);
}
</pre></div>
				
			</div>

			
<div class="section">
<h3><a name="More_tag_methods"></a>More tag methods</h3>
				
				
<p>
					FHIR also provides a number of operations to interact directly
					with tags. These methods may be used to retrieve lists of tags
					that are available on the server, or to add or remove tags from
					resources without interacting directly with those resources.			
				</p>

				
<p>
					On a server these methods may be placed in a plain provider, or in a resource
					provider in the case of resource type specific methods.
				</p>
				
					
					
				
<div class="source">
<pre>public class TagMethodProvider 
{
  /** Return a list of all tags that exist on the server */
  @GetTags
  public TagList getAllTagsOnServer() {
    return new TagList(); // populate this
  }

  /** Return a list of all tags that exist on at least one instance
   *  of the given resource type */
  @GetTags(type=Patient.class)
  public TagList getTagsForAllResourcesOfResourceType() {
    return new TagList(); // populate this
  }

  /** Return a list of all tags that exist on a specific instance
   *  of the given resource type */
  @GetTags(type=Patient.class)
  public TagList getTagsForResources(@IdParam IdDt theId) {
    return new TagList(); // populate this
  }

  /** Return a list of all tags that exist on a specific version
   *  of the given resource type */
  @GetTags(type=Patient.class)
  public TagList getTagsForResourceVersion(@IdParam IdDt theId) {
    return new TagList(); // populate this
  }

  /** Add tags to a resource */
  @AddTags(type=Patient.class)
  public void getTagsForResourceVersion(@IdParam IdDt theId, 
                                        @TagListParam TagList theTagList) {
    // add tags
  }

  /** Add tags to a resource version */
  @AddTags(type=Patient.class)
  public void addTagsToResourceVersion(@IdParam IdDt theId,
                                       @TagListParam TagList theTagList) {
    // add tags
  }

  /** Remove tags from a resource */
  @DeleteTags(type=Patient.class)
  public void deleteTagsFromResourceVersion(@IdParam IdDt theId,
                                            @TagListParam TagList theTagList) {
    // add tags
  }

}
</pre></div>
				
				
<p>
					On a client, the methods are defined in the exact same way, except that
					there is no method body in the client interface.
				</p>
				
			</div>
			
		</div>
		
	


                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2014
                        <a href="http://www.uhn.ca">University Health Network</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        <script type="text/javascript">
	var elements = document.getElementsByClassName("source");
	for (var i=0; i < elements.length; i++) {
		var pres = elements[i].getElementsByTagName("pre");
		for (var j = 0; j < pres.length; j++) {
			var pre = pres[j];
			if (pre.innerHTML.match(/\/\*/)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\/\//)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\{/)) {
				pre.className = 'brush: jscript';
			} else if (pre.innerHTML.match(/^\#/)) {
				pre.className = 'brush: bash';
			} else if (pre.innerHTML.match(/\&lt\;\//)) {
				pre.className = 'brush: xml';
			} else {
				pre.className = 'brush: java';
			}
		}
	}

	SyntaxHighlighter.all();
</script>
<script type="text/javascript">
	var elements = document.getElementsByClassName("source");
	for (var i=0; i < elements.length; i++) {
		var pres = elements[i].getElementsByTagName("pre");
		for (var j = 0; j < pres.length; j++) {
			var pre = pres[j];
			if (pre.innerHTML.match(/\/\*/)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\/\//)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\{/)) {
				pre.className = 'brush: jscript';
			} else if (pre.innerHTML.match(/^\#/)) {
				pre.className = 'brush: bash';
			} else if (pre.innerHTML.match(/\&lt\;\//)) {
				pre.className = 'brush: xml';
			} else {
				pre.className = 'brush: java';
			}
		}
	}

	SyntaxHighlighter.all();
</script>
<script type="text/javascript">
	var elements = document.getElementsByClassName("source");
	for (var i=0; i < elements.length; i++) {
		var pres = elements[i].getElementsByTagName("pre");
		for (var j = 0; j < pres.length; j++) {
			var pre = pres[j];
			if (pre.innerHTML.match(/\/\*/)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\/\//)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\{/)) {
				pre.className = 'brush: jscript';
			} else if (pre.innerHTML.match(/^\#/)) {
				pre.className = 'brush: bash';
			} else if (pre.innerHTML.match(/\&lt\;\//)) {
				pre.className = 'brush: xml';
			} else {
				pre.className = 'brush: java';
			}
		}
	}

	SyntaxHighlighter.all();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1395874-5', 'auto');
  ga('require', 'displayfeatures');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script>
                </body >
</html>