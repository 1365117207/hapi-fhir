<!DOCTYPE html>
<!--/*
************************************************************
This file is a Thymeleaf template for the 
************************************************************
*/-->

<html>
	<head>
		<script type="text/javascript">
			var serverBase = "<th:block th:text="${base}"/>";	
			var conformance = <th:block th:utext="${jsonEncodedConf}"/>;
		</script>
		<script type="text/javascript" src="jquery-2.1.0.min.js"></script>
		<script type="text/javascript" src="PublicTester.js"></script>
		<link rel="stylesheet" type="text/css" href="PublicTester.css"/>
		<meta charset="UTF-8"/>
		<script type="text/javascript" src="json2.js"></script>
		<script type="text/javascript" src="minify.json.js"></script>
	</head>
	<body onload="selectResourceType();">
		<table border="0" width="100%">
			<tr>
				<td align="left"><img src="hapi_fhir_banner.png"/></td>
				<td align="right"><img src="hapi_fhir_banner_right.png"/></td>
			</tr>
		</table>
		<div class="bodyHeaderBlock">
			This is a RESTful server tester, which can be used to send requests to, and receive responses 
			from the server at the following URL:<br/>
			<a href="http://foo.com/fhir" th:href="${base}"><th:block th:text="${base}">http://foo.com/fhir</th:block></a> 
		</div>
		
		<table border="0" width="100%" cellpadding="0" cellspacing="0" style="margin-top: 4px;">
			<tr>
				<td width="29%" valign="top">
					
					<div class="bodyHeaderBlock">
						Software Details
					</div>
					<table border="0" class="propertyTable">
						<tr>
							<td class="propertyKeyCell">Software</td>
							<td th:text="${conf.software.name}">HAPI Restful Server</td>
						</tr>
						<tr>
							<td class="propertyKeyCell">Version</td>
							<td th:text="${conf.software.version}">1.1.1</td>
						</tr>
					</table>

					<div class="bodyHeaderBlock">
						Request Configuration
					</div>
					<table border="0" class="propertyTable">
						<tr>
							<td class="propertyKeyCell">Encoding</td>
							<td>
								<select id="configEncoding" th:switch="${configEncoding}">
									<th:block th:case="'xml'">
										<option value="">(default)</option>
										<option value="xml" selected="selected">XML</option>
										<option value="json">JSON</option>
									</th:block>
									<th:block th:case="'json'">
										<option value="">(default)</option>
										<option value="xml">XML</option>
										<option value="json" selected="selected">JSON</option>
									</th:block>
									<th:block th:case="*">
										<option value="" selected="selected">(default)</option>
										<option value="xml">XML</option>
										<option value="json">JSON</option>
									</th:block>
								</select>
							</td>
						</tr>
						<tr>
							<td class="propertyKeyCell">Pretty Printing</td>
							<td th:switch="${configPretty}">
								<input th:case="'false'" type="checkbox" id="configPretty"/>
								<input th:case="*" type="checkbox" id="configPretty" checked="checked"/>
							</td>
						</tr>
					</table>
					
				</td>
				
				<td width="1%"/>
				
				<td width="70%" valign="top">
					<th:block th:each="rest : ${conf.rest}">
						<div class="bodyHeaderBlock">
							RESTful Server 
						</div>
						<table border="0" th:id="systemExpando" class="propertyTable">
							<tr>
								<td valign="top" class="propertyKeyCell">Supports operations:</td>
								<td valign="top">
									<a th:onclick="'displayConformance(this, \'systemExpando\'); return false;'" href="#">conformance</a>
									<th:span th:each="operation : ${rest.operation}">
										<th:block th:switch="${operation.code.value}">
											<span th:case="*" th:text="${operation.code.value}"/>
										</th:block>
									</th:span>												
								</td>
							</tr>
						</table>
						
						<div class="bodyHeaderBlock">
							Resources 
						</div>

						<table border="0" th:id="systemExpando" class="propertyTable">
							<tr>
								<td valign="top" class="propertyKeyCell">Select Resource:</td>
								<td valign="top">
									<select id="configResource" onchange="selectResourceType();">
										<th:block th:each="resource, resIterStat : ${rest.resource}">
											<option th:value="${resource.type.valueAsString}" th:text="${resource.type.valueAsString}"/>
										</th:block>
									</select>
								</td>
							</tr>
						</table>

						<div th:each="resource, resIterStat : ${rest.resource}" th:with="expandoId='resExpando'+${resIterStat.count}" th:id="'res' + ${resource.type.valueAsString}" class="resourceTypeContainer" style="display:none;">
							<div class="bodyHeaderBlock">
								Resource: <th:block th:text="${resource.type.valueAsString}"/> 
							</div>
							<table border="0" th:id="${expandoId}" class="propertyTable">
								<tr>
									<td valign="top" class="propertyKeyCell">Supports operations:</td>
									<td valign="top">
										<th:span th:each="operation : ${resource.operation}">
											<th:block th:switch="${operation.code.value}">
											    <a th:case="'read'"             href="#" th:onclick="'displayRead(this,            \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">read</a>
											    <a th:case="'vread'"            href="#" th:onclick="'displayVRead(this,           \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">vread</a>
											    <a th:case="'search-type'"      href="#" th:onclick="'displaySearchType(this,      \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">search-type</a>
											    <a th:case="'create'"           href="#" th:onclick="'displayCreate(this,          \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">create</a>
											    <a th:case="'update'"           href="#" th:onclick="'displayUpdate(this,          \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">update</a>
											    <a th:case="'validate'"         href="#" th:onclick="'displayValidate(this,        \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">validate</a>
											    <a th:case="'delete'"           href="#" th:onclick="'displayDelete(this,          \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">delete</a>
											    <a th:case="'history-instance'" href="#" th:onclick="'displayHistoryInstance(this, \'' + ${expandoId} + '\', \'' + ${resource.type.valueAsString} + '\'); return false;'">history-instance</a>
												<span th:case="*"               href="#" th:text="${operation.code.value}"/>
											</th:block>
										</th:span>												
									</td>
								</tr>
							</table>
						</div>
					</th:block>
				</td>
			</tr>
		</table>
			
		
	</body>
</html>
